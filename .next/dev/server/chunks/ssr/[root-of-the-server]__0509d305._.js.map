{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/GMMF/gmmf_donut_nextjs/components/CrashWatch.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, useMemo, useRef } from \"react\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\ninterface Country {\r\n  id: number;\r\n  name: string;\r\n  risk_score: number;\r\n  headline: string;\r\n}\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\nconst supabase = createClient(supabaseUrl, supabaseKey);\r\n\r\nexport default function CrashWatch() {\r\n  const [countries, setCountries] = useState<Country[]>([]);\r\n  const [prevCountries, setPrevCountries] = useState<Record<number, number>>({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [fade, setFade] = useState(false);\r\n  const [heartbeatSpeed, setHeartbeatSpeed] = useState(3);\r\n  const [utcTime, setUtcTime] = useState<string>(\"\");\r\n  const [lastUpdated, setLastUpdated] = useState<string>(\"\");\r\n  const [flashColor, setFlashColor] = useState<string>(\"\");\r\n\r\n  const prevAvgRisk = useRef<number>(0);\r\n  const audioCtx = useRef<AudioContext | null>(null);\r\n\r\n  // === smooth harmonic tone ===\r\n  function playAlertSound(type: \"warning\" | \"stable\" = \"warning\") {\r\n    if (!audioCtx.current)\r\n      audioCtx.current = new (window.AudioContext ||\r\n        (window as any).webkitAudioContext)();\r\n\r\n    const ctx = audioCtx.current;\r\n    const osc1 = ctx.createOscillator();\r\n    const osc2 = ctx.createOscillator();\r\n    const gain = ctx.createGain();\r\n\r\n    osc1.connect(gain);\r\n    osc2.connect(gain);\r\n    gain.connect(ctx.destination);\r\n\r\n    if (type === \"warning\") {\r\n      osc1.frequency.value = 440;\r\n      osc2.frequency.value = 660;\r\n    } else {\r\n      osc1.frequency.value = 240;\r\n      osc2.frequency.value = 360;\r\n    }\r\n\r\n    const start = ctx.currentTime;\r\n    gain.gain.setValueAtTime(0.0001, start);\r\n    gain.gain.exponentialRampToValueAtTime(0.25, start + 0.25);\r\n    gain.gain.exponentialRampToValueAtTime(0.001, start + 1.8);\r\n\r\n    osc1.start();\r\n    osc2.start();\r\n    osc1.stop(start + 2);\r\n    osc2.stop(start + 2);\r\n  }\r\n\r\n  // === Supabase fetch ===\r\n  async function fetchCountries() {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from(\"countries\")\r\n        .select(\"*\")\r\n        .order(\"risk_score\", { ascending: false });\r\n      if (error) throw error;\r\n\r\n      const map: Record<number, number> = {};\r\n      data?.forEach((c) => (map[c.id] = c.risk_score));\r\n      setPrevCountries((prev) => ({ ...prev, ...map }));\r\n      setCountries(data || []);\r\n\r\n      setLastUpdated(new Date().toLocaleTimeString());\r\n      setFade(true);\r\n      setTimeout(() => setFade(false), 400);\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error loading countries\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchCountries();\r\n    const interval = setInterval(fetchCountries, 60_000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  // === global average ===\r\n  const avgRisk = useMemo(() => {\r\n    if (!countries.length) return 0;\r\n    return (\r\n      countries.reduce((sum, c) => sum + (c.risk_score || 0), 0) /\r\n      countries.length\r\n    );\r\n  }, [countries]);\r\n\r\n  // === global alert trigger ===\r\n  useEffect(() => {\r\n    if (!countries.length) return;\r\n\r\n    if (prevAvgRisk.current < 80 && avgRisk >= 80) {\r\n      playAlertSound(\"warning\");\r\n      setFlashColor(\"red\");\r\n      setTimeout(() => setFlashColor(\"\"), 1800);\r\n    } else if (prevAvgRisk.current >= 80 && avgRisk < 80) {\r\n      playAlertSound(\"stable\");\r\n      setFlashColor(\"blue\");\r\n      setTimeout(() => setFlashColor(\"\"), 1800);\r\n    }\r\n\r\n    prevAvgRisk.current = avgRisk;\r\n  }, [avgRisk, countries]);\r\n\r\n  // === heartbeat / UTC clock ===\r\n  useEffect(() => {\r\n    const update = () => {\r\n      const hour = new Date().getUTCHours();\r\n      setHeartbeatSpeed(hour >= 0 && hour < 7 ? 2 : hour < 14 ? 2.5 : hour < 21 ? 2 : 4);\r\n      setUtcTime(new Date().toUTCString().split(\" \")[4]);\r\n    };\r\n    update();\r\n    const i1 = setInterval(update, 1000);\r\n    return () => clearInterval(i1);\r\n  }, []);\r\n\r\n  // === color logic ===\r\n  const shimmerColor =\r\n    avgRisk >= 80\r\n      ? \"from-red-500 via-rose-500 to-red-400\"\r\n      : avgRisk >= 50\r\n      ? \"from-amber-400 via-yellow-400 to-amber-300\"\r\n      : \"from-blue-400 via-sky-500 to-blue-400\";\r\n\r\n  const shimmerLabel =\r\n    avgRisk >= 80\r\n      ? \"‚ö†Ô∏è Global Stress High\"\r\n      : avgRisk >= 50\r\n      ? \"üü° Moderate Risk\"\r\n      : \"üü¶ Stable Conditions\";\r\n\r\n  const clockGlow =\r\n    avgRisk >= 80\r\n      ? \"text-red-600\"\r\n      : avgRisk >= 50\r\n      ? \"text-amber-500\"\r\n      : \"text-blue-500\";\r\n\r\n  const flashClass =\r\n    flashColor === \"red\"\r\n      ? \"animate-flashRed\"\r\n      : flashColor === \"blue\"\r\n      ? \"animate-flashBlue\"\r\n      : \"\";\r\n\r\n  return (\r\n    <div\r\n      className={`bg-white border rounded-lg shadow-sm h-full flex flex-col transition-all relative overflow-hidden ${flashClass}`}\r\n    >\r\n      {/* Flash overlay */}\r\n      {flashColor && (\r\n        <div\r\n          className={`absolute top-0 left-0 right-0 h-1 ${\r\n            flashColor === \"red\" ? \"bg-red-500\" : \"bg-blue-500\"\r\n          }`}\r\n        ></div>\r\n      )}\r\n\r\n      {/* Header */}\r\n      <div className=\"p-4 flex items-center justify-between mb-1\">\r\n        <h2 className=\"text-sm font-semibold uppercase tracking-wide text-slate-600\">\r\n          Crash Watch\r\n        </h2>\r\n        <div\r\n          className={`w-3 h-3 rounded-full bg-gradient-to-r ${shimmerColor}`}\r\n          style={{\r\n            animation: `heartbeat ${heartbeatSpeed}s ease-in-out infinite`,\r\n          }}\r\n        ></div>\r\n      </div>\r\n\r\n      {/* UTC Clock */}\r\n      <div\r\n        className={`text-[11px] font-semibold mb-3 ${clockGlow} px-4`}\r\n        style={{\r\n          textShadow:\r\n            avgRisk >= 80\r\n              ? \"0 0 8px rgba(220,38,38,0.8)\"\r\n              : avgRisk >= 50\r\n              ? \"0 0 8px rgba(245,158,11,0.7)\"\r\n              : \"0 0 8px rgba(59,130,246,0.7)\",\r\n          animation: `glowPulse ${heartbeatSpeed}s ease-in-out infinite`,\r\n        }}\r\n      >\r\n        üåê UTC Time | {utcTime || \"Loading...\"}\r\n      </div>\r\n\r\n      {/* Risk label */}\r\n      <div\r\n        className={`text-xs font-medium mb-2 text-right px-4 ${\r\n          avgRisk >= 80\r\n            ? \"text-red-600\"\r\n            : avgRisk >= 50\r\n            ? \"text-amber-500\"\r\n            : \"text-blue-600\"\r\n        }`}\r\n      >\r\n        {shimmerLabel}\r\n      </div>\r\n\r\n      {/* Country List */}\r\n      <div className=\"px-4 pb-4 flex-1 overflow-y-auto\">\r\n        {loading ? (\r\n          <div className=\"text-slate-500 text-sm\">Loading countries‚Ä¶</div>\r\n        ) : (\r\n          <ul\r\n            className={`space-y-2 transition-opacity duration-500 ${\r\n              fade ? \"opacity-50\" : \"opacity-100\"\r\n            }`}\r\n          >\r\n            {countries.map((c) => {\r\n              const prev = prevCountries[c.id];\r\n              const hasChanged = prev !== undefined && prev !== c.risk_score;\r\n              const changeColor =\r\n                c.risk_score >= 80\r\n                  ? \"bg-red-100\"\r\n                  : c.risk_score >= 50\r\n                  ? \"bg-amber-100\"\r\n                  : \"bg-blue-100\";\r\n\r\n              return (\r\n                <li\r\n                  key={c.id}\r\n                  className={`flex justify-between items-center border-b pb-1 text-sm px-1 rounded transition-all duration-[1500ms] ease-in-out ${\r\n                    hasChanged ? changeColor : \"bg-transparent\"\r\n                  }`}\r\n                >\r\n                  <span className=\"font-medium text-slate-700\">{c.name}</span>\r\n                  <span\r\n                    className={`font-semibold ${\r\n                      c.risk_score >= 80\r\n                        ? \"text-red-600\"\r\n                        : c.risk_score >= 50\r\n                        ? \"text-amber-500\"\r\n                        : \"text-blue-600\"\r\n                    }`}\r\n                  >\r\n                    {c.risk_score}\r\n                  </span>\r\n                </li>\r\n              );\r\n            })}\r\n          </ul>\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer */}\r\n      <div className=\"mt-1 text-[11px] text-slate-400 text-right px-4 pb-2\">\r\n        Last updated {lastUpdated || \"‚Äì\"}\r\n      </div>\r\n\r\n      <style jsx global>{`\r\n        @keyframes heartbeat {\r\n          0%,100%{transform:scale(1);opacity:.85}\r\n          30%{transform:scale(1.3);opacity:1}\r\n          60%{transform:scale(1.1);opacity:.95}\r\n        }\r\n        @keyframes glowPulse {\r\n          0%,100%{filter:brightness(1);opacity:.9}\r\n          30%{filter:brightness(1.3);opacity:1}\r\n          60%{filter:brightness(1.1);opacity:.95}\r\n        }\r\n        @keyframes flashRed {\r\n          0%{box-shadow:0 0 0 rgba(220,38,38,0)}\r\n          25%{box-shadow:0 0 25px rgba(220,38,38,0.6)}\r\n          100%{box-shadow:0 0 0 rgba(220,38,38,0)}\r\n        }\r\n        @keyframes flashBlue {\r\n          0%{box-shadow:0 0 0 rgba(59,130,246,0)}\r\n          25%{box-shadow:0 0 25px rgba(59,130,246,0.6)}\r\n          100%{box-shadow:0 0 0 rgba(59,130,246,0)}\r\n        }\r\n        .animate-flashRed{animation:flashRed 2s ease-out}\r\n        .animate-flashBlue{animation:flashBlue 2s ease-out}\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 316, "column": 0}, "map": {"version":3,"sources":["file:///C:/GMMF/gmmf_donut_nextjs/components/GlobeView.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\nimport Globe from \"react-globe.gl\";\r\n\r\nconst supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n\r\ninterface CountryData {\r\n  id: number;\r\n  name: string;\r\n  region: string;\r\n  risk_score: number;\r\n}\r\n\r\ninterface GlobeViewProps {\r\n  width?: number;\r\n  height?: number;\r\n  regionPing?: string;\r\n}\r\n\r\nconst COUNTRY_COORDS: Record<string, { lat: number; lng: number }> = {\r\n  US: { lat: 37.0902, lng: -95.7129 },\r\n  CN: { lat: 35.8617, lng: 104.1954 },\r\n  IN: { lat: 20.5937, lng: 78.9629 },\r\n  DE: { lat: 51.1657, lng: 10.4515 },\r\n  JP: { lat: 36.2048, lng: 138.2529 },\r\n  BR: { lat: -14.235, lng: -51.9253 },\r\n  NG: { lat: 9.082, lng: 8.6753 },\r\n  RU: { lat: 61.524, lng: 105.3188 },\r\n  ZA: { lat: -30.5595, lng: 22.9375 },\r\n  AU: { lat: -25.2744, lng: 133.7751 }\r\n};\r\n\r\nexport default function GlobeView({\r\n  width = 320,\r\n  height = 320,\r\n  regionPing\r\n}: GlobeViewProps) {\r\n  const globeRef = useRef<any>();\r\n  const [data, setData] = useState<CountryData[]>([]);\r\n  const [hovered, setHovered] = useState<string | null>(null);\r\n  const [angle, setAngle] = useState(0);\r\n\r\n  // === Fetch from Supabase ===\r\n  async function loadData() {\r\n    const { data, error } = await supabase.from(\"countries\").select(\"*\");\r\n    if (error) console.error(\"‚ùå Error loading Supabase data:\", error);\r\n    if (data) setData(data);\r\n  }\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n\r\n    const channel = supabase\r\n      .channel(\"countries-live\")\r\n      .on(\r\n        \"postgres_changes\",\r\n        { event: \"UPDATE\", schema: \"public\", table: \"countries\" },\r\n        (payload) => {\r\n          const updated = payload.new as CountryData;\r\n          setData((prev) =>\r\n            prev.map((c) => (c.id === updated.id ? updated : c))\r\n          );\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  }, []);\r\n\r\n  // === Build globe labels ===\r\n  const labels = Object.keys(COUNTRY_COORDS).map((code) => {\r\n    const match = data.find(\r\n      (c) => c.region?.toUpperCase() === code.toUpperCase()\r\n    );\r\n    const score = match?.risk_score ?? 0;\r\n    let color = \"rgba(147,197,253,0.9)\";\r\n    if (score >= 80) color = \"rgba(239,68,68,0.9)\";\r\n    else if (score >= 60) color = \"rgba(251,191,36,0.9)\";\r\n\r\n    return {\r\n      ...COUNTRY_COORDS[code],\r\n      text: code,\r\n      size: hovered === code ? 3.2 : 1.6,\r\n      color: hovered === code ? \"rgba(255,255,255,1)\" : color,\r\n      risk_score: score,\r\n      name: match?.name || code\r\n    };\r\n  });\r\n\r\n  // === Auto-focus on selected region ===\r\n  useEffect(() => {\r\n    if (!globeRef.current) return;\r\n    if (regionPing && COUNTRY_COORDS[regionPing]) {\r\n      const coords = COUNTRY_COORDS[regionPing];\r\n      globeRef.current.pointOfView(\r\n        { lat: coords.lat, lng: coords.lng, altitude: 1.5 },\r\n        1500\r\n      );\r\n    }\r\n  }, [regionPing]);\r\n\r\n  // === Rotate radar sweep head ===\r\n  useEffect(() => {\r\n    const timer = setInterval(() => {\r\n      setAngle((prev) => (prev + 2) % 360);\r\n    }, 100);\r\n    return () => clearInterval(timer);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      {/* === Globe === */}\r\n      <Globe\r\n        ref={globeRef}\r\n        width={width}\r\n        height={height}\r\n        backgroundColor=\"rgba(0,0,0,0)\"\r\n        globeImageUrl=\"//unpkg.com/three-globe/example/img/earth-dark.jpg\"\r\n        bumpImageUrl=\"//unpkg.com/three-globe/example/img/earth-topology.png\"\r\n        showAtmosphere\r\n        atmosphereColor=\"lightskyblue\"\r\n        atmosphereAltitude={0.2}\r\n        labelsData={labels}\r\n        labelLat={(d: any) => d.lat}\r\n        labelLng={(d: any) => d.lng}\r\n        labelText={(d: any) => d.text}\r\n        labelSize={(d: any) => d.size}\r\n        labelColor={(d: any) => d.color}\r\n        labelDotRadius={0.6}\r\n        labelResolution={2}\r\n        animateIn\r\n        onLabelHover={(label: any) => setHovered(label ? label.text : null)}\r\n        onLabelClick={(label: any) => setHovered(label.text)}\r\n        labelAltitude={(d: any) => (hovered === d.text ? 0.05 : 0.01)}\r\n      />\r\n\r\n      {/* === Tooltip on hover === */}\r\n      {hovered && (\r\n        <div className=\"absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900/90 text-slate-100 text-xs rounded-md px-3 py-2 shadow-lg backdrop-blur-sm border border-slate-700 pointer-events-none animate-fade\">\r\n          {(() => {\r\n            const country = labels.find((l) => l.text === hovered);\r\n            const risk = country?.risk_score ?? 0;\r\n            const status =\r\n              risk >= 80\r\n                ? \"‚ö†Ô∏è High Risk\"\r\n                : risk >= 60\r\n                ? \"üü° Moderate\"\r\n                : \"üü¶ Stable\";\r\n            return (\r\n              <div>\r\n                <div className=\"font-semibold text-sm\">{country?.name}</div>\r\n                <div className=\"text-amber-300\">Risk Score: {risk}</div>\r\n                <div className=\"text-slate-400\">{status}</div>\r\n              </div>\r\n            );\r\n          })()}\r\n        </div>\r\n      )}\r\n\r\n      {/* === Radar sweep & sweep head === */}\r\n      <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\r\n        {/* radar beam */}\r\n        <div className=\"w-[160%] h-[160%] rounded-full bg-[conic-gradient(from_0deg,rgba(59,130,246,0.2)_0deg,rgba(250,204,21,0.25)_60deg,transparent_120deg)] animate-radar blur-xl opacity-40\" />\r\n        {/* sweep head */}\r\n        <div\r\n          className=\"absolute w-4 h-4 rounded-full bg-amber-300 blur-md opacity-80 animate-pulse\"\r\n          style={{\r\n            transform: `rotate(${angle}deg) translateX(120px)`\r\n          }}\r\n        />\r\n      </div>\r\n\r\n      {/* === Legend Overlay === */}\r\n      <div className=\"absolute top-3 right-3 bg-white/80 backdrop-blur-sm border border-slate-200 rounded-md text-[11px] text-slate-700 p-2 shadow-md\">\r\n        <div className=\"font-semibold text-[12px] mb-1 text-slate-800\">Legend</div>\r\n        <div className=\"flex items-center gap-1\">\r\n          <span className=\"w-3 h-3 rounded-full bg-blue-400\" /> <span>Stable</span>\r\n        </div>\r\n        <div className=\"flex items-center gap-1\">\r\n          <span className=\"w-3 h-3 rounded-full bg-amber-400\" /> <span>Moderate</span>\r\n        </div>\r\n        <div className=\"flex items-center gap-1\">\r\n          <span className=\"w-3 h-3 rounded-full bg-red-500\" /> <span>High Risk</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* === Animations === */}\r\n      <style jsx global>{`\r\n        @keyframes fade {\r\n          from { opacity: 0; transform: translateY(-4px); }\r\n          to { opacity: 1; transform: translateY(0); }\r\n        }\r\n        .animate-fade { animation: fade 0.3s ease-out forwards; }\r\n\r\n        @keyframes radar {\r\n          0% { transform: rotate(0deg); }\r\n          100% { transform: rotate(360deg); }\r\n        }\r\n        .animate-radar {\r\n          animation: radar 6s linear infinite;\r\n          transform-origin: center;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 647, "column": 0}, "map": {"version":3,"sources":["file:///C:/GMMF/gmmf_donut_nextjs/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport CrashWatch from \"@/components/CrashWatch\";\nimport GlobeView from \"@/components/GlobeView\";\n\nexport default function HomePage() {\n  return (\n    <main className=\"min-h-screen bg-slate-50 text-slate-800 p-6\">\n      {/* --------- TOP HEADER --------- */}\n      <header className=\"sticky top-0 z-30 bg-white/80 backdrop-blur border-b shadow-sm mb-6\">\n        <div className=\"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-2xl md:text-3xl font-bold tracking-tight text-slate-900\">\n              eX Intelligence Dashboard\n            </h1>\n            <p className=\"text-sm text-slate-600\">\n              Real-time global financial risk intelligence powered by Supabase ‚ö°Ô∏è\n            </p>\n          </div>\n          <img\n            src=\"/crowned_x.svg\"\n            alt=\"eX Logo\"\n            className=\"w-10 h-10 opacity-80\"\n          />\n        </div>\n      </header>\n\n      {/* --------- GRID LAYOUT --------- */}\n      <div className=\"max-w-7xl mx-auto grid md:grid-cols-[260px,1fr,260px] gap-4 items-start\">\n        \n        {/* LEFT COLUMN ‚Äî CRASH WATCH */}\n        <CrashWatch />\n\n        {/* CENTER COLUMN ‚Äî GLOBE / VISUAL AREA */}\n        <section className=\"rounded-xl border bg-white p-6 shadow-sm min-h-[600px] grid place-items-center\">\n          <div className=\"w-full\">\n            <h2 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center justify-between\">\n              üåç Global Overview\n              <span className=\"text-xs text-slate-500 font-normal\">\n                Connected to Supabase ‚úÖ\n              </span>\n            </h2>\n            <div className=\"border rounded-lg bg-slate-100 grid place-items-center h-[400px]\">\n              <GlobeView width={420} height={360} title=\"Global Risk View\" />\n            </div>\n          </div>\n        </section>\n\n        {/* RIGHT COLUMN ‚Äî TIMELINE / PLACEHOLDER */}\n        <aside className=\"rounded-xl border bg-white p-6 shadow-sm min-h-[600px]\">\n          <h2 className=\"text-sm uppercase tracking-wide text-slate-500 mb-2\">\n            Predictive Timeline\n          </h2>\n          <p className=\"text-sm text-slate-600 mb-4\">\n            This panel will visualize risk trajectories and prediction trends over time.\n          </p>\n          <div className=\"border rounded-lg p-3 text-center text-slate-400 text-sm\">\n            Coming soon: Timeline with historical alerts, market data, and forecast indicators.\n          </div>\n        </aside>\n      </div>\n\n      {/* --------- FOOTER --------- */}\n      <footer className=\"text-center text-xs text-slate-500 mt-10 pb-6\">\n        v1.0 ‚Äî GMMF Baseline ¬∑ Powered by Supabase + Next.js ¬∑ Designed by eX üú≤\n      </footer>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS;IACtB,qBACE,8OAAC;QAAK,WAAU;;0BAEd,8OAAC;gBAAO,WAAU;0BAChB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;;8CACC,8OAAC;oCAAG,WAAU;8CAA+D;;;;;;8CAG7E,8OAAC;oCAAE,WAAU;8CAAyB;;;;;;;;;;;;sCAIxC,8OAAC;4BACC,KAAI;4BACJ,KAAI;4BACJ,WAAU;;;;;;;;;;;;;;;;;0BAMhB,8OAAC;gBAAI,WAAU;;kCAGb,8OAAC,oIAAU;;;;;kCAGX,8OAAC;wBAAQ,WAAU;kCACjB,cAAA,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;;wCAA8E;sDAE1F,8OAAC;4CAAK,WAAU;sDAAqC;;;;;;;;;;;;8CAIvD,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC,mIAAS;wCAAC,OAAO;wCAAK,QAAQ;wCAAK,OAAM;;;;;;;;;;;;;;;;;;;;;;kCAMhD,8OAAC;wBAAM,WAAU;;0CACf,8OAAC;gCAAG,WAAU;0CAAsD;;;;;;0CAGpE,8OAAC;gCAAE,WAAU;0CAA8B;;;;;;0CAG3C,8OAAC;gCAAI,WAAU;0CAA2D;;;;;;;;;;;;;;;;;;0BAO9E,8OAAC;gBAAO,WAAU;0BAAgD;;;;;;;;;;;;AAKxE","debugId":null}}]
}