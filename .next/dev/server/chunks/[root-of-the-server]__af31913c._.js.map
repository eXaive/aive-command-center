{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///C:/GMMF/gmmf_donut_nextjs/app/api/news/route.ts"],"sourcesContent":["import Parser from \"rss-parser\";\r\n\r\nexport async function GET(req: Request) {\r\n  const { searchParams } = new URL(req.url);\r\n  const asset = searchParams.get(\"asset\") || \"\";\r\n  const topic = searchParams.get(\"topic\") || \"global\";\r\n  const region = searchParams.get(\"region\") || \"\";\r\n  const limit = Number(searchParams.get(\"limit\") || 10);\r\n\r\n  const parser = new Parser();\r\n  let feeds: string[] = [];\r\n\r\n  if (topic.includes(\"energy\") || asset === \"OIL\") {\r\n    feeds = [\r\n      \"https://oilprice.com/rss/main\",\r\n      \"https://www.reutersagency.com/feed/?best-sectors=energy\",\r\n    ];\r\n  } else if (topic.includes(\"crypto\") || [\"BTC\",\"ETH\",\"SOL\"].includes(asset)) {\r\n    feeds = [\r\n      \"https://cointelegraph.com/rss\",\r\n      \"https://news.bitcoin.com/feed/\",\r\n      \"https://decrypt.co/feed\",\r\n    ];\r\n  } else if (topic.includes(\"politic\") || topic.includes(\"geo\")) {\r\n    feeds = [\r\n      \"https://feeds.bbci.co.uk/news/world/rss.xml\",\r\n      \"https://www.reutersagency.com/feed/?best-topics=politics\",\r\n    ];\r\n  } else if (topic.includes(\"economy\") || topic.includes(\"rates\") || topic.includes(\"cpi\")) {\r\n    feeds = [\r\n      \"https://www.ft.com/rss/economy\",\r\n      \"https://www.reutersagency.com/feed/?best-sectors=markets-economy\",\r\n    ];\r\n  } else {\r\n    feeds = [\r\n      \"https://www.reutersagency.com/feed/?best-sectors=markets\",\r\n      \"https://www.cnbc.com/id/10001147/device/rss/rss.html\",\r\n    ];\r\n  }\r\n\r\n  try {\r\n    const allItems: any[] = [];\r\n    for (const url of feeds) {\r\n      try {\r\n        const feed = await parser.parseURL(url);\r\n        if (feed.items?.length) allItems.push(...feed.items);\r\n      } catch (err) {\r\n        console.error(\"⚠️ RSS fetch failed:\", url, err);\r\n      }\r\n    }\r\n\r\n    const items = allItems\r\n      .filter((i) => i.title && i.link)\r\n      .slice(0, limit)\r\n      .map((i) => ({\r\n        title: i.title,\r\n        link: i.link,\r\n        pubDate: i.pubDate,\r\n        source: new URL(i.link).hostname,\r\n      }));\r\n\r\n    return Response.json({ asset, topic, region, total: items.length, items });\r\n  } catch (e) {\r\n    console.error(\"❌ Failed to fetch news:\", e);\r\n    return Response.json({ error: \"Failed to fetch RSS feed\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,IAAI,GAAY;IACpC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,QAAQ,aAAa,GAAG,CAAC,YAAY;IAC3C,MAAM,QAAQ,aAAa,GAAG,CAAC,YAAY;IAC3C,MAAM,SAAS,aAAa,GAAG,CAAC,aAAa;IAC7C,MAAM,QAAQ,OAAO,aAAa,GAAG,CAAC,YAAY;IAElD,MAAM,SAAS,IAAI,mJAAM;IACzB,IAAI,QAAkB,EAAE;IAExB,IAAI,MAAM,QAAQ,CAAC,aAAa,UAAU,OAAO;QAC/C,QAAQ;YACN;YACA;SACD;IACH,OAAO,IAAI,MAAM,QAAQ,CAAC,aAAa;QAAC;QAAM;QAAM;KAAM,CAAC,QAAQ,CAAC,QAAQ;QAC1E,QAAQ;YACN;YACA;YACA;SACD;IACH,OAAO,IAAI,MAAM,QAAQ,CAAC,cAAc,MAAM,QAAQ,CAAC,QAAQ;QAC7D,QAAQ;YACN;YACA;SACD;IACH,OAAO,IAAI,MAAM,QAAQ,CAAC,cAAc,MAAM,QAAQ,CAAC,YAAY,MAAM,QAAQ,CAAC,QAAQ;QACxF,QAAQ;YACN;YACA;SACD;IACH,OAAO;QACL,QAAQ;YACN;YACA;SACD;IACH;IAEA,IAAI;QACF,MAAM,WAAkB,EAAE;QAC1B,KAAK,MAAM,OAAO,MAAO;YACvB,IAAI;gBACF,MAAM,OAAO,MAAM,OAAO,QAAQ,CAAC;gBACnC,IAAI,KAAK,KAAK,EAAE,QAAQ,SAAS,IAAI,IAAI,KAAK,KAAK;YACrD,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,wBAAwB,KAAK;YAC7C;QACF;QAEA,MAAM,QAAQ,SACX,MAAM,CAAC,CAAC,IAAM,EAAE,KAAK,IAAI,EAAE,IAAI,EAC/B,KAAK,CAAC,GAAG,OACT,GAAG,CAAC,CAAC,IAAM,CAAC;gBACX,OAAO,EAAE,KAAK;gBACd,MAAM,EAAE,IAAI;gBACZ,SAAS,EAAE,OAAO;gBAClB,QAAQ,IAAI,IAAI,EAAE,IAAI,EAAE,QAAQ;YAClC,CAAC;QAEH,OAAO,SAAS,IAAI,CAAC;YAAE;YAAO;YAAO;YAAQ,OAAO,MAAM,MAAM;YAAE;QAAM;IAC1E,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,SAAS,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF","debugId":null}}]
}