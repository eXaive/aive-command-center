module.exports=[70406,(e,t,i)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},14747,(e,t,i)=>{t.exports=e.x("path",()=>require("path"))},22734,(e,t,i)=>{t.exports=e.x("fs",()=>require("fs"))},94543,(e,t,i)=>{t.exports=e.x("pdfkit",()=>require("pdfkit"))},46810,(e,t,i)=>{t.exports=e.x("svg-to-pdfkit",()=>require("svg-to-pdfkit"))},32318,e=>{"use strict";var t=e.i(26747),i=e.i(90406),o=e.i(44898),l=e.i(62950),n=e.i(94543),a=e.i(14747),r=e.i(22734),s=e.i(46810);let d={GOLD:{display:"Gold (XAU/USD)",yfSymbol:"GC=F",topics:["dxy","rates","energy","news-tone"]},SILVER:{display:"Silver (XAG/USD)",yfSymbol:"SI=F",topics:["dxy","rates","energy","news-tone"]},OIL:{display:"WTI Crude (CL)",yfSymbol:"CL=F",topics:["energy","geopolitics","rates","news-tone"]},SPY:{display:"S&P 500 (SPY)",yfSymbol:"SPY",topics:["rates","liquidity","credit","news-tone"]},QQQ:{display:"NASDAQ 100 (QQQ)",yfSymbol:"QQQ",topics:["rates","tech-ai","liquidity","news-tone"]},DXY:{display:"US Dollar Index",yfSymbol:"DX-Y.NYB",topics:["rates","macro","news-tone"]},US10Y:{display:"US 10Y Yield",yfSymbol:"^TNX",topics:["inflation","macro","news-tone"]},BTC:{display:"Bitcoin (BTC)",yfSymbol:"BTC-USD",topics:["btc-flows","regulation","liquidity","news-tone"]},ETH:{display:"Ethereum (ETH)",yfSymbol:"ETH-USD",topics:["tech-ai","regulation","liquidity","news-tone"]},SOL:{display:"Solana (SOL)",yfSymbol:"SOL-USD",topics:["tech-ai","regulation","liquidity","news-tone"]},NVDA:{display:"NVIDIA (NVDA)",yfSymbol:"NVDA",topics:["tech-ai","rates","news-tone"]},AAPL:{display:"Apple (AAPL)",yfSymbol:"AAPL",topics:["tech-ai","supply-chains","news-tone"]},TSLA:{display:"Tesla (TSLA)",yfSymbol:"TSLA",topics:["energy","tech-ai","news-tone"]}},f="GOLD",c=["beats","surge","soar","record","bull","expands","grow","rises","gain","optimism","cuts rates","stimulus","eases"],p=["miss","falls","drop","slump","recession","bear","cuts","loss","default","war","hike","tighten","sanction"];function u(e){let t=(e||"").toLowerCase(),i=0;return c.forEach(e=>i+=+!!t.includes(e)),p.forEach(e=>i-=!!t.includes(e)),i}async function y(e){try{let t=await fetch(e,{cache:"no-store",headers:{"user-agent":"GMMF-PDF/1.2"}});if(!t.ok)return null;return await t.json()}catch{return null}}function h(e,t,i){return Math.max(t,Math.min(i,e))}function m(e){return e>.66?"#2563eb":e>.15?"#60a5fa":e<-.66?"#dc2626":e<-.15?"#f87171":"#94a3b8"}function g(e,t){return null!=e&&null!=t&&isFinite(e)&&isFinite(t)&&0!==t?(e-t)/t*100:null}async function w(e,t){let i,o,l,c,p,w,S,v,x,b,C,D=(i=e.headers["x-forwarded-proto"]||e.headers["x-forwarded-protocol"]||"http",o=e.headers.host||"localhost:3000",`${i}://${o}`),A=(e.query.asset?.toString()||f).toUpperCase(),$=d[A]||d[f],H=await y(`${D}/api/news?asset=${encodeURIComponent(A)}`),T=Array.isArray(H?.items)?H.items.slice(0,7):[],E=T.map(e=>u(e.title||"")),k=E.length?E.reduce((e,t)=>e+t,0)/E.length:0,P=$.topics.length?$.topics:["news-tone"],q={};await Promise.all(P.map(async e=>{let t=await y(`${D}/api/topic/${e}`),i=(Array.isArray(t?.items)?t.items.slice(0,20):[]).map(e=>u(e.title||"")),o=i.length?i.reduce((e,t)=>e+t,0)/i.length:0;q[e]=h(o/3,-1,1)}));let L=await y(`${D}/api/series?symbol=${encodeURIComponent($.yfSymbol)}&range=2mo&interval=1d`),U=L?.series||[],z=L?.lastClose??null,B=null;U.length>=7?B=g(U[U.length-1].close,U[U.length-7].close):U.length>=5&&(B=g(U[U.length-1].close,U[U.length-5].close));let R=new n.default({margin:50,size:"LETTER"}),F=[];t.setHeader("Content-Type","application/pdf"),t.setHeader("Content-Disposition",`inline; filename=${A}_Brief.pdf`),R.on("data",e=>F.push(e)),R.on("end",()=>t.send(Buffer.concat(F)));let I=a.default.resolve("./public/crowned_x.svg"),N=a.default.resolve("./public/logo.png");try{if(r.default.existsSync(I)){let e=r.default.readFileSync(I,"utf8");(0,s.default)(R,e,460,36,{width:110,height:110})}else r.default.existsSync(N)&&R.image(N,460,40,{width:110})}catch{}R.font("Helvetica-Bold").fontSize(18).fillColor("#111827").text($.display,50,50),R.font("Helvetica").fontSize(10).fillColor("#475569").text("Monitor Everything that affects Finance",50,72),R.fontSize(9).fillColor("#6b7280").text(`As of ${new Date().toLocaleString()}`,50,86),!function(e,t,i,o,l,n){if(e.save(),e.rect(50,105,520,64).strokeColor("#e5e7eb").lineWidth(1).stroke(),!n||n.length<2){e.font("Helvetica").fontSize(9).fillColor("#6b7280").text("No series",56,132),e.restore();return}let a=n.map(e=>e.close),r=Math.min(...a),s=Math.max(...a),d=e=>56+508*e/(n.length-1),f=e=>s>r?163-(e-r)*52/(s-r):137;e.save(),e.moveTo(d(0),f(a[0]));for(let t=1;t<a.length;t++)e.lineTo(d(t),f(a[t]));e.lineTo(d(a.length-1),163).lineTo(d(0),163).closePath(),e.fillColor("#dbeafe").fill(),e.restore(),e.moveTo(d(0),f(a[0]));for(let t=1;t<a.length;t++)e.lineTo(d(t),f(a[t]));e.strokeColor("#2563eb").lineWidth(1.5).stroke(),e.circle(d(a.length-1),f(a[a.length-1]),1.8).fill("#1f2937"),e.restore()}(R,0,0,0,0,U);let M="—";null!=B&&Number.isFinite(B)&&(M=`${B>=0?"+":""}${B.toFixed(2)}% (≈7d)`),R.font("Helvetica").fontSize(9).fillColor("#111827").text(`Last close: ${null!=z?z.toFixed(2):"—"}   •   ${M}`,58,175),R.moveDown(1),R.moveDown(1),R.font("Helvetica-Bold").fontSize(12).fillColor("#111827").text("Executive Summary",{underline:!0}),R.moveDown(.5),R.font("Helvetica").fontSize(10).fillColor("#111827").text(`${$.display} remains sensitive to macro conditions. Over the recent period, headline tone is ${k>.2?"tilted moderately positive":k<-.2?"tilted cautious":"mixed"}.`,{align:"justify"}),R.moveDown(1.2),R.font("Helvetica-Bold").fontSize(12).fillColor("#111827").text("Market Factors",{underline:!0}),R.moveDown(.5),P.forEach((e,t)=>{let i=e.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()),o="dxy"===e?"Stronger dollar is typically a headwind; softer dollar can support.":"rates"===e?"Higher real yields tend to weigh on risk and gold; easing supports.":"energy"===e?"Energy backdrop influences inflation and risk tone.":"btc-flows"===e?"Net inflows and liquidity often support digital assets.":"tech-ai"===e?"Innovation cycle & earnings momentum shape equity risk tone.":"Headline tone blended from sources.",l=R.y+(0===t?4:26),n=q[e]??0;R.font("Helvetica-Bold").fontSize(10).fillColor("#111827").text(i,50,l-2),function(e,t,i,o,l,n){let a=h(n,-1,1);e.save(),e.rect(200,i,370,10).fill("#e5e7eb"),e.fill("#ffffff").rect(384.25,i,1.5,10).fill(),e.fill("#fecaca").rect(200,i,185,10).fill(),e.fill("#bfdbfe").rect(385,i,185,10).fill();let r=m(a);if(a>=0)e.fill(r).rect(385,i,185*a,10).fill();else{let t=-(185*a);e.fill(r).rect(385-t,i,t,10).fill()}e.restore()}(R,200,l-6,370,0,n),R.font("Helvetica").fontSize(8.5).fillColor("#475569").text(o,50,l+10,{width:520})}),R.moveDown(2),R.font("Helvetica-Bold").fontSize(12).fillColor("#111827").text("Top Headlines",{underline:!0}),R.moveDown(.5),T.length?T.forEach(e=>{let t=m(h(u(e.title||"")/3,-1,1));R.rect(R.x,R.y+3,6,6).fill(t).strokeColor(t).stroke().fillColor("#111827"),R.moveUp(.35),R.font("Helvetica-Bold").fontSize(10).text(`   ${e.title||""}`,{width:500});let i=[e.source,e.pubDate?new Date(e.pubDate).toLocaleString():""].filter(Boolean).join(" • ");i&&R.font("Helvetica").fontSize(8.5).fillColor("#64748b").text(i),R.moveDown(.25)}):R.font("Helvetica").fontSize(10).fillColor("#475569").text("No headlines available at the moment."),R.moveDown(1),R.font("Helvetica-Bold").fontSize(12).fillColor("#111827").text("From All Indications",{underline:!0}),R.moveDown(.4);let Q=(l=q.dxy??0,c=q.rates??0,p=q.energy??0,w=q["news-tone"]??0,S=[],v=[],l<-.2&&v.push("a softer dollar tone"),l>.2&&S.push("dollar strength"),c<-.2&&v.push("easing yields"),c>.2&&S.push("higher yields"),p>.2&&v.push("a firm energy backdrop"),p<-.2&&S.push("a weaker energy backdrop"),x=v.length?`Tailwinds include ${v.join(" and ")}.`:"",b=S.length?` Headwinds include ${S.join(" and ")}.`:"",C=d[A]?.display||A,`From all indications, ${C} shows a near-term bias shaped by ${w>.2?"constructive news flow":w<-.2?"cautious news flow":"mixed news flow"}. ${x}${b}`);R.font("Helvetica").fontSize(10).fillColor("#111827").text(Q,{align:"justify"}),R.moveDown(1.2),R.font("Helvetica").fontSize(9).fillColor("#475569").text("This document is generated automatically for informational purposes only and does not constitute financial advice or an investment recommendation.",{align:"center"}),R.end()}e.s(["default",()=>w],45390);var S=e.i(45390),v=e.i(7031),x=e.i(81927),b=e.i(46432);let C=(0,l.hoist)(S,"default"),D=(0,l.hoist)(S,"config"),A=new o.PagesAPIRouteModule({definition:{kind:i.RouteKind.PAGES_API,page:"/api/brief",pathname:"/api/brief",bundlePath:"",filename:""},userland:S,distDir:".next",relativeProjectDir:""});async function $(e,i,o){A.isDev&&(0,b.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let l="/api/brief";l=l.replace(/\/index$/,"")||"/";let n=await A.prepare(e,i,{srcPage:l});if(!n){i.statusCode=400,i.end("Bad Request"),null==o.waitUntil||o.waitUntil.call(o,Promise.resolve());return}let{query:a,params:r,prerenderManifest:s,routerServerContext:d}=n;try{let t=e.method||"GET",o=(0,v.getTracer)(),n=o.getActiveScopeSpan(),f=A.instrumentationOnRequestError.bind(A),c=async n=>A.render(e,i,{query:{...a,...r},params:r,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:s.preview,propagateError:!1,dev:A.isDev,page:"/api/brief",internalRevalidate:null==d?void 0:d.revalidate,onError:(...t)=>f(e,...t)}).finally(()=>{if(!n)return;n.setAttributes({"http.status_code":i.statusCode,"next.rsc":!1});let e=o.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==x.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=e.get("next.route");if(a){let e=`${t} ${a}`;n.setAttributes({"next.route":a,"http.route":a,"next.span_name":e}),n.updateName(e)}else n.updateName(`${t} ${l}`)});n?await c(n):await o.withPropagatedContext(e.headers,()=>o.trace(x.BaseServerSpan.handleRequest,{spanName:`${t} ${l}`,kind:v.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},c))}catch(e){if(A.isDev)throw e;(0,t.sendError)(i,500,"Internal Server Error")}finally{null==o.waitUntil||o.waitUntil.call(o,Promise.resolve())}}e.s(["config",0,D,"default",0,C,"handler",()=>$],32318)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__7d8425eb._.js.map